{% extends "dialog.html" %}
{% load i18n %}

{% block extra-page-id %}
	id="create-proposal"
{% endblock %}

{% block page_header %}
    {% if form.instance.id %}
        {% trans "Edit Proposal" %}
    {% else %}
        {% trans "New Proposal" %}
    {% endif %}
{% endblock %}

{% block header-end %}
{% endblock %}

{% block content %}

    {{ form }}

<script>

	function refreshProposalForm() {

		// prevent html5 required field
		$('#id_proposal-type').val() == '';

		// hide task related fields
		var els = $('#id_proposal-assigned_to').parent().parent();
		var els1 = $('#id_proposal-due_by').parent().parent();
		if ($('#id_proposal-type').val() == '1') {
			els.show();
			els1.show();
		} else {
			els.hide();
			els1.hide();
		}

	}


	function refreshProposalEditForm() {

		// prevent html5 required field
		$('#id_type').val() == '';
		// hide task related fields
		if ($('#id_type').val() == '1') {
			$('#id_assigned_to').closest('.form-group').show()
         $('#id_due_by').closest('.form-group').show()
		} else {
         $('#id_assigned_to').closest('.form-group').hide()
			$('#id_due_by').closest('.form-group').hide()
		}

	}
	

	$(function() {
      refreshProposalEditForm();
      refreshProposalForm();
      {% verbatim %}
      var tpl = '<p>{{#board}}<strong>{{/board}}{{user__display_name}}{{#board}}</strong>{{/board}}</p>'
      var tpl1 = '<p><strong>-- {{value}} --</strong></p>'
      {% endverbatim %}
      $('body').on('change', '#id_proposal-type', refreshProposalForm);
		$('body').on('change', '#id_type', refreshProposalEditForm);
		$('#id_assigned_to').typeahead({
            
            remote: '{% url "ac_user" community_id=community.id %}?q=%QUERY',
            valueKey: 'user__display_name',
            engine: Hogan,
            template: tpl
          }).css('background-color', '#fff');

	});
</script>

{% endblock %}
